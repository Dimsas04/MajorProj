# extract_features_task:
#   description: >
#     Given a product URL, identify the most important features users usually consider
#     when reviewing this type of product. Examples of features include Battery Life, Camera Quality,
#     Durability, Performance, etc.
#     MAKE SURE TO EXTRACT FEATURES THAT ARE RELEVANT TO THE PRODUCT TYPE. 

#     Focus only on extracting **relevant product features**, without diving into sentiment or reviews.

#     Product URL: {product_input}

#     Output must be a valid JSON array of feature names.
#   expected_output: >
#     A JSON object containing a "features" array of key product features. **DO NOT INCLUDE BACKTICKS (```) OR THE WORD 'json' IN THE OUTPUT. THE OUTPUT SHOULD START AT OPENING CURLY BRACES AND END AT CLOSING CURLY BRACES **.
#   agent: feature_extractor

extract_features_task:
  description: >
    Given a product URL, identify the most important features users usually consider
    when reviewing this type of product.
    
    Product URL: {product_input}
    
    IMPORTANT: First determine what type of product this is (e.g., shoes, electronics, etc.) 
    by analyzing the URL structure and any keywords present. Then extract features SPECIFICALLY
    for that product type.
    
    For example:
    - For shoes/footwear: Consider features like Comfort, Fit, Durability, Style, Sole quality, etc.
    - For electronics: Consider features like Performance, Battery life, Display quality, etc.
    - For clothing: Consider features like Material quality, Design, Sizing accuracy, etc.

    Focus only on extracting **relevant product features** for the specific product type.

    Output must be a valid JSON object with:
    1. "product_type": The type of product detected
    2. "features": Array of key features relevant to this product type

  expected_output: >
    A JSON object containing "product_type" and a "features" array of key product features.
    **DO NOT INCLUDE BACKTICKS (```) OR THE WORD 'json' IN THE OUTPUT.
    THE OUTPUT SHOULD START AT OPENING CURLY BRACES AND END AT CLOSING CURLY BRACES**.
  agent: feature_extractor

# New task for comprehensive review analysis
comprehensive_review_analysis_task:
  description: >
    Analyze the product reviews across ALL the extracted features.

    Features to analyze: {features}

    Reviews: {reviews}

    For EACH feature, provide a separate analysis section in your response.
    
    Your output must be a valid JSON array where each element is an analysis object for one feature.
    
    Each analysis object should contain:
    - "feature": The name of the feature being analyzed
    - "sentiment": Overall sentiment (Positive, Negative, Mixed, or Neutral)
    - "key_points": Array of points mentioned in reviews with their frequency counts
    - "verdict": A concise summary of user opinion on this feature
  expected_output: >
    A JSON array where each element analyzes one product feature based on user reviews.
  agent: review_analysis_agent
  context:
    - extract_features_task

analyze_feature_task:
  description: >
    For the feature: "{feature_name}", analyze the user reviews of the product from the perspective
    of that feature only.

    Reviews:
    {reviews}

    Output must be a valid JSON object containing:
    - Feature name
    - Sentiment
    - Key points (with frequency count)
    - Overall verdict

    Example Output:
    {
      "feature": "Battery Life",
      "sentiment": "Positive",
      "key_points": [
        {"point": "Lasts for 2 days", "frequency": 32},
        {"point": "Charges quickly", "frequency": 18}
      ],
      "verdict": "Users are very satisfied with the battery life, highlighting long-lasting performance and fast charging."
    }
  expected_output: >
    A valid JSON object summarizing the sentiment and key insights for the given feature.
  agent: review_analysis_agent
  context:
    - extract_features_task

# Task for Review Scraper Agent
# scrape_reviews_task:
#   description: >
#     Scrape product reviews for the product: "{product_url}"

#     Your task is to collect authentic and relevant reviews from e-commerce platforms
#     based on the product URL. Ensure to retrieve reviews that cover a wide range of user
#     experiences, including both positive and negative feedback.
#   expected_output: >
#     A list of product reviews in JSON format, including user ratings and review content.
#   agent: review_scraper

scrape_reviews_task:
  description: >
    Scrape product reviews for the product: {product_url}
    
    Your task is to collect authentic and relevant reviews from e-commerce platforms
    based on the product URL. Use the Amazon Scraper Tool to extract reviews from the provided URL.

    IMPORTANT: Use EXACTLY the URL provided without any modifications. DO NOT replace the URL with an example URL.

    If the provided URL is from amazon.in (Indian site) or any other regional Amazon site, use that exact URL.

    Instructions:
    1. Use the amazon_scraper_tool with the exact URL provided
    2. Target 50 reviews unless otherwise specified
    3. If provided, use the product name parameter

    Specify the number of reviews to scrape and provide the product name if available.
  expected_output: >
    Path to a CSV file containing the scraped reviews with ratings and content.
  agent: review_scraper


# scrape_reviews_task:
#   description: >
#     "Scrape customer reviews from the product URL: {product_url}"
    
#     "Your task is to use the amazon_scraper_tool to collect actual customer reviews from this URL.
    
#     "VERY IMPORTANT: When calling the amazon_scraper_tool, you must provide a JSON object with these exact keys:
#     {
#       "url": "{product_url}",
#       "target_reviews": 10,
#       "product_name": "{product_name}"
#     }
#     "
    
#     DO NOT modify the URL in any way - use it exactly as provided.
#   expected_output: >
#     A confirmation that reviews were successfully scraped and saved to a CSV file.
#   agent: review_scraper

# Task for Manager Agent
coordinate_workflow_task:
  description: >
    Manage the workflow for Revify by coordinating between agents.

    Your task is to:
    1. Trigger the feature extraction task for the given product.
    2. Initiate the review scraping process.
    3. Delegate the review analysis to the review analysis agent based on the extracted features.
    4. Compile the final results and ensure all agents perform their tasks successfully.
  expected_output: >
    A final report summarizing the product's feature-based review analysis, combining results
    from the feature extraction and review analysis agents.
  agent: manager_agent
  context:
    - extract_features_task
    - scrape_reviews_task

